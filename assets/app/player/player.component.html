<div id="OpenQueue"
	(click)="playerService.player.openQueue()"
	*ngIf="playerService.player.visible">
	<md-icon>
		queue_music
	</md-icon>
</div>

<div id="Queue"
	class="queue-closed"
	[ngClass]="{'queue-closed': playerService.player.queueOpen == false}"
	*ngIf="playerService.player.visible">

	<div style="display: block; box-sizing: border-box; height: 5%; min-height: 5%; max-height: 5%;">
		<h3 style="text-transform: lowercase;">
			Now Playing
			<button md-icon-button id="CloseQueue" (click)="playerService.player.closeQueue()">
				<md-icon>
					close
				</md-icon>
			</button>
		</h3>
	</div>

	<!-- Player -->
	<div id="Player">
		<div *ngIf="playerService.player.currentTrack">
			<img class="now-playing-art" src="{{playerService.player.currentTrack.album.imagePath}}" style="float: left;"/>

			<div
				class="now-playing"
				*ngIf="playerService.player.currentTrack">
				<h3 class="now-playing-field" style="color: rgba(255, 255, 255, 0.87);">
					{{playerService.player.currentTrack.name}}
				</h3>
				<em class="now-playing-field" style="color: rgba(255, 255, 255, 0.54);">
					<md-icon style="font-size: 14px; height: 18px; width: 18px;">
						album
					</md-icon>
					{{playerService.player.currentTrack.album.name}} ({{playerService.player.currentTrack.album.year}})
				</em><br />
				<span class="now-playing-field" style="color: rgba(255, 255, 255, 0.54);">
					<md-icon style="font-size: 14px; height: 18px; width: 18px;">
						person
					</md-icon>
					{{playerService.player.currentTrack.album.artist.name}}
				</span><br />
				<span class="now-playing-field" style="color: rgba(255, 255, 255, 0.36);">
					<md-icon style="font-size: 14px; height: 18px; width: 18px;">
						receipt
					</md-icon>
					<em>
						{{playerService.player.currentTrack.genre}}
					</em>
				</span>
			</div>

			<div style="width: 100%;">
				<div style="float: left; font-size: 46px;">
					<md-icon
						class="player-control player-pause"
						*ngIf="!playerService.player.audio.paused"
						(click)="playerService.player.pause()">
						pause
					</md-icon>
					<md-icon
						class="player-control player-play"
						*ngIf="playerService.player.audio.paused"
						(click)="playerService.player.resume()">
						play_arrow
					</md-icon>

					<md-icon
						class="player-control player-play"
						*ngIf="playerService.player.volume >= 0.8"
						(click)="playerService.player.mute()">
						volume_up
					</md-icon>
					<md-icon
						class="player-control player-play"
						*ngIf="playerService.player.volume >= 0.4 && playerService.player.volume < 0.8"
						(click)="playerService.player.mute()">
						volume_down
					</md-icon>
					<md-icon
						class="player-control player-play"
						*ngIf="playerService.player.volume > 0 && playerService.player.volume < 0.4"
						(click)="playerService.player.mute()">
						volume_mute
					</md-icon>
					<md-icon
						class="player-control player-play"
						*ngIf="playerService.player.volume == 0"
						(click)="playerService.player.unmute()">
						volume_off
					</md-icon>

					<!-- Volume -->
					<md-slider min="0.0" max="1.0" step="0.05" value="0.5" [(ngModel)]="volume" ></md-slider>
				</div>

				<div style="float: right;">
					<div class="now-playing-elapsed" style="margin-top: 24px;">
						{{playerService.player.elapsed}} / {{playerService.player.currentTrack.lengthFormatted}}
					</div>
				</div>
			</div>


			<md-progress-bar
				class="now-playing-progress"
				[mode]="determinate"
				[value]="playerService.player.elapsedPercent">
			</md-progress-bar>
		</div>
		<div *ngIf="!playerService.player.currentTrack">
			<p style="color: rgba(80, 80, 80, 0.87);">
				Nothing currently playing
			</p>
		</div>
	</div>

	<div style="float: right; margin-right: 6px;">
		<button md-icon-button
			(click)="surpriseMe()">
			<md-icon>casino</md-icon>
		</button>
	</div>

	<div class="queue-list" *ngIf="playerService.player.queue.length">

		<div
			class="queue-item"
			*ngFor="let track of playerService.player.queue; let i = index"
			[style.backgroundColor]="playerService.player.queuePosition == i ? 'rgba(0, 0, 0, 0.13)' : null">

			<span style="float: left;" *ngIf="playerService.player.queuePosition == i">
				<md-icon
					class="player-control player-pause"
					 *ngIf="!playerService.player.audio.paused"
					(click)="playerService.player.pause()">
					pause
				</md-icon>
				<md-icon
					class="player-control player-play"
					 *ngIf="playerService.player.audio.paused"
					(click)="playerService.player.resume()" >
					play_arrow
				</md-icon>
			</span>

			<span style="float: left;" *ngIf="playerService.player.queuePosition != i">
				<md-icon
					class="player-control player-play"
					(click)="playerService.player.playPosition(i)" >
					play_arrow
				</md-icon>
			</span>

			<span class="queue-item-field">
				<span class="queue-item-field-text">
					{{i+1}}. {{ track.name }}
				</span>
				<span style="float: right; padding-top: 1px; color: rgba(255, 255, 255, 0.34);">
					{{track.lengthFormatted}}
				</span>
			</span>
		</div>
	</div>
	<div class="queue-list" *ngIf="playerService.player.queue.length == 0" style="text-align: center;">
		<md-icon class="error-icon">
			queue_music
		</md-icon><br />
		<div class="error-text">
			No music queued
		</div>
	</div>
</div>
